fs.inotify.max_user_instances=8192
fs.inotify.max_user_watches=1048576
net.core.rmem_max=67108864
net.core.wmem_max=67108864


##############################
# 邻居表 (ARP/NDP 缓存) 调优
##############################

net.ipv4.neigh.default.gc_thresh1=4096
net.ipv4.neigh.default.gc_thresh2=8192
net.ipv4.neigh.default.gc_thresh3=16384

##############################
# TCP 拥塞控制与连接优化
##############################

# 拥塞控制算法
# 默认值: cubic
net.ipv4.tcp_congestion_control = bbr

# TCP Fast Open，减少握手延迟
# 0=关闭, 1=客户端, 2=服务端, 3=双端
# 默认值: 0 (旧内核), 新内核可能是 1
net.ipv4.tcp_fastopen = 3

# TCP MTU 探测，避免路径 MTU 黑洞问题
# 0=禁用, 1=出现问题时启用, 2=总是启用
# 默认值: 0
net.ipv4.tcp_mtu_probing = 1

##############################
# TCP 缓冲区 (单位: 字节)
##############################

# TCP 接收缓冲区: [最小值 默认值 最大值]
# 默认值: 4096 87380 6291456
net.ipv4.tcp_rmem = 4096 87380 33554432

# TCP 发送缓冲区: [最小值 默认值 最大值]
# 默认值: 4096 16384 4194304
net.ipv4.tcp_wmem = 4096 65536 33554432

# TCP 窗口缩放 (RFC 1323)，允许窗口 >64KB
# 默认值: 1 (开启)
net.ipv4.tcp_window_scaling = 1

##############################
# 用户命名空间
##############################

# 最大用户命名空间数
user.max_user_namespaces = 55334
